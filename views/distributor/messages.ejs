<%- include('./partials/header', { title: title || 'Messages - SLEX', lng: lng || 'uz', user: user }) %>
<%- include('./partials/sidebar', { user: user, currentPage: 'messages' }) %>

<!-- Main Content -->
<main class="admin-main buyer-messages">
  <div class="admin-content">
    
    <!-- Messages Header -->
    <div class="messages-header animate-fade-in">
      <div class="messages-header-content">
        <div class="messages-title-section">
          <h1 class="messages-main-title">
            <i class="fas fa-comments"></i>
            <%- t('buyerMessages.title') %>
          </h1>
          <p class="messages-subtitle"><%- t('buyerMessages.subtitle') %></p>
        </div>
        <div class="messages-header-actions">
          <button class="btn btn-primary" id="newMessageBtn">
            <i class="fas fa-plus"></i>
            <%- t('buyerMessages.newMessage') %>
          </button>
        </div>
      </div>
    </div>

    <!-- Messages Content -->
    <div class="messages-content-grid animate-fade-in">
      
      <!-- Conversations List -->
      <div class="conversations-panel">
        <div class="panel-header">
          <h3><%- t('buyerMessages.conversations') %></h3>
          <div class="search-box">
            <input type="text" placeholder="<%- t('buyerMessages.searchConversations') %>" id="conversationSearch">
            <i class="fas fa-search"></i>
          </div>
        </div>
        <div class="conversations-list" id="conversationsList">
          <!-- Conversations will be loaded dynamically -->
          <div class="conversation-item active">
            <div class="conversation-avatar">
              <img src="/assets/images/avatars/default-company.png" alt="Supplier">
            </div>
            <div class="conversation-info">
              <h4>Premium Textiles Co.</h4>
              <p><%- t('buyerMessages.lastMessage') %> #ORD-2024-001</p>
              <span class="conversation-time">2 <%- t('buyerMessages.hoursAgo') %></span>
            </div>
            <div class="conversation-indicators">
              <span class="unread-badge">2</span>
            </div>
          </div>
          
          <div class="conversation-item">
            <div class="conversation-avatar">
              <img src="/assets/images/avatars/default-company.png" alt="Supplier">
            </div>
            <div class="conversation-info">
              <h4>Silk Road Industries</h4>
              <p><%- t('buyerMessages.lastMessage') %> RFQ Response</p>
              <span class="conversation-time">1 <%- t('buyerMessages.dayAgo') %></span>
            </div>
          </div>
          
          <div class="conversation-item">
            <div class="conversation-avatar">
              <img src="/assets/images/avatars/default-company.png" alt="Supplier">
            </div>
            <div class="conversation-info">
              <h4>Cotton Masters Ltd</h4>
              <p><%- t('buyerMessages.lastMessage') %> Order Confirmation</p>
              <span class="conversation-time">3 <%- t('buyerMessages.daysAgo') %></span>
            </div>
          </div>
        </div>
      </div>

      <!-- Chat Window -->
      <div class="chat-panel">
        <div class="chat-header">
          <div class="chat-participant">
            <div class="participant-avatar">
              <img src="/assets/images/avatars/default-company.png" alt="Supplier">
            </div>
            <div class="participant-info">
              <h3>Premium Textiles Co.</h3>
              <span class="participant-status online"><%- t('buyerMessages.online') %></span>
            </div>
          </div>
          <div class="chat-actions">
            <button class="btn btn-icon">
              <i class="fas fa-phone"></i>
            </button>
            <button class="btn btn-icon">
              <i class="fas fa-video"></i>
            </button>
            <button class="btn btn-icon">
              <i class="fas fa-ellipsis-v"></i>
            </button>
          </div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
          <div class="message received">
            <div class="message-avatar">
              <img src="/assets/images/avatars/default-company.png" alt="Supplier">
            </div>
            <div class="message-content">
              <div class="message-text">
                <%- t('buyerMessages.sampleMessage1') %>
              </div>
              <span class="message-time">10:30 AM</span>
            </div>
          </div>
          
          <div class="message sent">
            <div class="message-content">
              <div class="message-text">
                <%- t('buyerMessages.sampleMessage2') %>
              </div>
              <span class="message-time">10:32 AM</span>
            </div>
          </div>
          
          <div class="message received">
            <div class="message-avatar">
              <img src="/assets/images/avatars/default-company.png" alt="Supplier">
            </div>
            <div class="message-content">
              <div class="message-text">
                <%- t('buyerMessages.sampleMessage3') %>
              </div>
              <span class="message-time">10:35 AM</span>
            </div>
          </div>
        </div>
        
        <div class="chat-input">
          <div class="input-actions">
            <button class="btn btn-icon">
              <i class="fas fa-paperclip"></i>
            </button>
            <button class="btn btn-icon">
              <i class="fas fa-image"></i>
            </button>
          </div>
          <div class="input-container">
            <input type="text" placeholder="<%- t('buyerMessages.typeMessage') %>" id="messageInput">
            <button class="btn btn-icon send-btn">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Messages JavaScript -->
<script src="/js/buyer/messages.js"></script>